#Project 

2024.03.26 ~ 2024.05.01 내일배움캠프에서 최종프로젝트를 진행하면서 진행사항과 구현 기능, 기술 스택 등 느낀 점들을 정리해 보는 회고록이다.

## 기획
[[1. 프로젝트의 목적]]
[[2. 주제 확정짓기]]
[[3. 도메인 분석]]
[[4. 기획]]


## 개발
### 개발
**crud**
1. 멀티 모듈 그래들 적응기
2. 파사드 패턴 적용
**test**
1. 테스트 코드에 대한 고찰
**monitoring**
1. 모니터링 툴 정하기 : 프로메테우스, 그라파나 vs 핀포인트 : 핀포인트 한 이틀 갈아넣었는데 서버가 못버티고 계속 터져서 돈 문제로 패스
2. 프로메테우스 그라파나 연동하기 : alb와 연동 이슈, 그래프 해석 문제, 슬랙 알람, 콘서트 열렸을때 운영, elk 서버 바꾸기
**elk**
1. elk 세팅 : 시큐리티 오류
2. 자바 클라이언트 선택
3. 인덱스 만들기
4. 애널라이저, 토크나이저 생성 - 자동완성
**캐싱, 락**
1. 캐싱, 락(redis) : 공부하자
**대기열**
1. sse와 scheduler : sse랑 polling중에서 프론터에 프록시 서버 때문에 polling방식 채택 - sse는 프론트에서 연결을 중간에 끊어버릴 수 있음 : 중간에 프록시 서버가 필요하지만 백엔드에 집중하기로 해서 polling채택
2. 스케쥴러 : 특정 트리거 발동 시에만 스케쥴러 작동시키기 - 없어서 스케쥴러 직접 만들어서 사용

처음에 sqs + lambda : sqs가 트래픽을 너무 못받아서 실패
redis 2개 사용 : 실패
webflux + redis 사용
8. webflux, sqs, redis 등

**트러블 슈팅**
1. 모니터링 : 프로메테우스 ,그라파나
2. elk security : docker vs opensearch
3. 검색 시간 개선
4. 분산 락 사용
5. 대기열 아키텍쳐 설계 : redis, webflux, sse, schedule, sqs, sms, lambda, redis 몇개 사용할건지, queue 2개 나누기

### **전체 기능**

**Infra**

- Terraform을 이용한 IaC 구축
- nat gateway를 통한 subnet 네트워크 환경 구성
- ECS와 Load Balancing 적용
- Rolling 방식의 무중단 배포 적용
- Jenkins를 이용한 CI-CD 파이프라인 구축

**서비스**

- ELK Stack을 이용한 검색&자동완성 시스템
- 대용량 좌석 생성을 위해 Spring Batch 서버 분리 및 적용
- 공연 사전 알림을 위해 MongoDB에 데이터를 적재하고 SES로 알림 발송
- Spring Webflux + Redis를 이용한 대기열 시스템 구현
- Batch에서 생성된 좌석 key를 Redis에 저장하여 Locking을 이용한 동시성 제어
- 운영을 위해 Prometheus&Grafana로 Monitoring 파이프라인 구축
- 트래픽 분산 처리를 위해 Database Replication(Master-Replica) 적용


---

transaction

concurrency control provides serializability & recoverability

-> 여러 트랜잭션이 같이 동작될때 항상 같은 결과를 낼 수 있느냐

serializability : 커밋을 어떻게 할거냐
recoverability : 롤백을 어떻게 할거냐

conflict : 같은 데이터에 접근할때 나는거

conflict equivalent

https://easy-code-yo.tistory.com/25
https://velog.io/@j_user0719/DB-Serializability-%EC%99%80-Recoverable

cascading rollback
strict schedule
-> isolation level 기준

벤더사마다 다름 -> mysql과 postgress도 다름
![[Pasted image 20240604151803.png]]
