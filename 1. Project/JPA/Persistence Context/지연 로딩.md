---
title: 지연 로딩
date: 2024-01-26 11:20
categories:
  - JPA
tags:
  - jpa
image: 
path:
---
#jpa 

## 지연 로딩
+ JPA는 연관관계가 설정된 Entity의 정보를 바로 가져올지, 필요할 때 가져올지 정할 수 있다.
- 가져오는 방법을 정하게되는데 JPA에서는 **Fetch Type**이라 부른다.
- 지연 로딩 역시 영속성 컨텍스트의 기능 중 하나이므로, 지연 로딩된 Entity의 정보를 조회하려고 할 때는 반드시 [[영속성 컨텍스트]]가 존재해야 한다. 이 의미는 결국 [[1. Project/JPA/트랜잭션/트랜잭션]]이 적용되어 있어야 한다는 의미와 같다.

### Fetch Type
- Fetch Type의 종류에는 2가지가 있는데 하나는 `LAZY`, 다른 하나는 `EAGER` 이다.
- annotation 이름에서 **뒤쪽에 Many**가 붙어있으면 설정된 해당 필드가 Java 컬렉션 타입일 것이다. 이는 해당 Entity의 정보가 여러 개 들어있을 수 있다는 것을 의미하므로, 효율적으로 정보를 조회하기 위해 **지연 로딩**(`LAZY`)이 default로 설정되어 있다.
- 반대로, **이름 뒤쪽이 One**일 경우 해당 Entity 정보가 한 개만 들어오기 때문에 즉시 정보를 가져와도 무리가 없어 **즉시 로딩**(`EAGER`)이 default로 설정되어 있다.

#### EAGER
+ food에 대한 정보를 조회하려 하는데 즉시 로딩에 의해 연관된 user에 대한 정보도 같이 넘어온다.

![[eager.png]]

#### LAZY
+ 지연 로딩으로 설정되어 있기 때문에 같이 넘어오지 않고 get 호출이 일어날 때(해당 정보가 필요한 시점)에 SQL이 수행된다.

![[lazy.png]]