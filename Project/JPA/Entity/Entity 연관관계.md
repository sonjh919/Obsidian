---
title: Entity 연관관계
date: 2024-01-25 14:40
categories:
  - JPA
tags:
  - jpa
image: 
path:
---

## 방향
[[DataBase]]에서의 테이블 간의 관계에서는 방향의 개념이 없다. 하지만 JPA [[Entity]]에서는 방향의 개념이 있다. JPA에서는 테이블에 실제 컬럼으로 존재하지는 않지만 Entity 상태에서 다른 Entity를 참조하기 위해 방향의 개념을 도입했다. **서로의 Entity를 참조할 수 있는 관계를 양방향 관계**라 부르며, **한쪽에서만 다른 Entity를 참조하는 것을 단방향 관계**라고 부른다. 

- DB 테이블에서는 테이블 사이의 연관관계를 FK(외래 키)로 맺을 수 있고 방향 상관없이 조회가 가능하다.
- Entity에서는 상대 Entity를 참조하여 Entity 사이의 연관관계를 맺을 수 있다.
- 하지만 상대 Entity를 참조하지 않고 있다면 상대 Entity를 조회할 수 있는 방법이 없다.
- 따라서 Entity에서는 DB 테이블에는 없는 방향의 개념이 존재한다.

### 관계 설정 방법
- 단방향이라면 외래 키의 주인만 상대 Entity 타입의 필드를 가지면서 @JoinColumn()을 활용하여 외래 키의 속성을 설정해준다.
- 양방향이라면 외래 키의 주인은 상대 Entity 타입의 필드를 가지면서 @JoinColumn()을 활용하여 외래 키의 속성을 설정을 해준다. 그리고 상대 Entity는 외래 키의 주인 Entity 타입의 필드를 가지면서 mappedBy 옵션을 사용하여 속성 값으로 외래 키의 주인 Entity에 선언된 @JoinColumn()으로 설정되고 있는 필드명을 넣어주면 된다.


>1. 외래 키의 주인 Entity에서 @JoinColumn() 애너테이션을 사용하지 않아도 default 옵션이 적용되기 때문에 생략이 가능다다.
    - 다만 1 대 N 관계에서 외래 키의 주인 Entity가 @JoinColumn() 애너테이션을 생략한다면 JPA가 외래 키를 저장할 컬럼을 파악할 수가 없어서 의도하지 않은 중간 테이블이 생성된다.
    - 따라서 외래 키의 주인 Entity에서 @JoinColumn() 애너테이션을 활용하시는게 좋다.
>2. 양방향 관계에서 mappedBy 옵션을 생략할 경우 JPA가 외래 키의 주인 Entity를 파악할 수가 없어 의도하지 않은 중간 테이블이 생성되기 때문에 반드시 설정해주는 것이 좋다.
{: .prompt-warning }


## 관계의 종류
+ [[1대 1 관계]]
+ N대 1 관계
+ 1대 N 관계
+ N대 M 관계
